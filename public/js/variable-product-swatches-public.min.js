!function(t,e,i,a){"use strict";function s(e,i){this.element=e,this.settings=t.extend({},{},i),this.$element=t(e),this.$element.addClass("variable-product-swatches-loaded"),this.product_variations=this.$element.data("product_variations")||[],this.is_ajax_variation=this.product_variations.length>0,this.wrapper=this.$element.closest(".type-product"),this.attributeFields=this.$element.find(".variations select"),this.cart_button=this.$element.find(".variable-product-swatches-add-to-cart-button"),this.cart_button_ajax=this.$element.find(".variable_product_swatches_ajax_add_to_cart"),this.is_archive=this.$element.hasClass("variable_product_swatches_archive_variations_form"),this.is_single=!this.is_archive,this.option=_VPS.option,this.init(),this.update(),this.tooltip(),this.stockcount(),this.selected()}t.extend(s.prototype,{init:function(){var e=this,i=!1;this.$element.find("ul.swatches-items-wrapper").each((function(a,s){t(this).parent().addClass("variable-product-swatches-items-wrapper");var n=t(this).siblings("select.variable-product-swatches-raw-select");setTimeout((function(){i||(n.trigger("change"),n.trigger("click"),n.trigger("focusin"),i=!0)}),100),t(this).on("click.variable-product-swatches","li",(function(i){i.preventDefault(),i.stopPropagation();var a=t(this).data("value");e.option.advanced.clear_on_reselect&&n.val()&&n.val()===a?n.val(""):n.val(a),n.trigger("change"),n.trigger("click"),n.trigger("focusin")}))}))},update:function(){var e=this;this.$element.on("woocommerce_variation_has_changed.variable-product-swatches",(function(i){t(this).find("ul.swatches-items-wrapper").each((function(i,a){var s=t(this).siblings("select.variable-product-swatches-raw-select"),n=t(this).find("li"),c=0===s.find("option:selected").length?s.find("option").eq(1).val():s.find("option:selected").val(),o=s.find("option"),r=s.find("option:disabled"),h=[];o.each((function(){""!==t(this).val()&&h.push(t(this).val())}));var l=[];r.each((function(){""!==t(this).val()&&l.push(t(this).val())}));var d=_.difference(h,l);e.is_ajax_variation?n.each((function(e,i){var a=t(this).attr("data-value");t(this).removeClass("swatch-item-selected").addClass("swatch-item-disabled"),_.includes(d,a)&&(t(this).removeClass("swatch-item-selected swatch-item-disabled"),a===c&&t(this).addClass("swatch-item-selected"))})):n.each((function(e,i){var a=t(this).attr("data-value");t(this).removeClass("swatch-item-selected").addClass("swatch-item-disabled"),_.includes(d,a)&&(t(this).removeClass("swatch-item-selected swatch-item-disabled"),a===c&&t(this).addClass("swatch-item-selected"))}))}))}))},tooltip:function(){if("on"!==_VPS.option.advanced.tooltip)return!1;this.$element.on("woocommerce_variation_has_changed.variable-product-swatches",(function(e){t(this).find("li.swatch-item").each((function(e,i){t(this).mouseover((function(){t(this).find(".swatch-item-tooltip").show()})),t(this).mouseleave((function(){t(this).find(".swatch-item-tooltip").hide()}))}))}))},stockcount:function(){if(!this.is_ajax_variation)return!1;var e=this;this.$element.on("woocommerce_variation_has_changed.variable-product-swatches",(function(i){for(var a=t(this).find("ul.swatches-items-wrapper").find("li.swatch-item-selected"),s=[],n=[],c=0;c<a.length;c++)s.push(t(a[c]).data("value")),n.push(t(a[c]).parent().data("attribute_name"));t(this).find("li.swatch-item").each((function(i,a){for(var c=t(this).data("value"),o=t(this).parent().data("attribute_name"),r=0,h=0;h<e.product_variations.length;h++){var l=e.product_variations[h],d=l.attributes,u=l.stock_quantity,v=e.checkemptykey(d);if(d[o]==c||!d[o]){for(var p=0;p<s.length;p++)!1===Object.values(d).includes(s[p])&&n[p]!==o&&d[o]&&!v.length&&(u=0),v&&(v.includes(n[p])||!1===Object.values(d).includes(s[p])&&n[p]!==o&&(u=0));r+=u}}t(this).find(".swatch-item-stock-count").text(r+" left")}))}))},selected:function(){if("on"!==_VPS.option.advanced.show_selected_variation)return!1;this.$element.on("woocommerce_variation_has_changed.variable-product-swatches",(function(e){t("body").hasClass("variable-product-swatches-show-selected-attribute")&&t(this).find("li.swatch-item").each((function(e,i){if(t(this).hasClass("swatch-item-selected")){var a=t(this).data("title");0===t(this).parents("tr").find("td.label .selected-attribute").length&&t(this).parents("tr").find("td.label").append('<span class="selected-attribute"></span>'),t(this).parents("tr").find("td.label .selected-attribute").text(" "+_VPS.option.advanced.label_separator+" "+a)}0==t(this).parent().find(".swatch-item-selected").length&&t(this).parents("tr").find("td.label .selected-attribute").remove()}))}))},checkemptykey:function(t){var e=[];for(const[i,a]of Object.entries(t))a||e.push(i);return e}}),t.fn.VPS=function(e){return this.each((function(){t.data(this,"FN_VPS")||t.data(this,"FN_VPS",new s(this,e))}))}}(jQuery,window,document),function(t){"use strict";t(document).on("wc_variation_form.variable-product-swatches",".variations_form:not(.variable-product-swatches-loaded)",(function(e){t(this).VPS()}))}(jQuery);